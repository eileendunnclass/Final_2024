---
title: "Covid91 vaccine study Final2024"  
author: "Eileen Dunn"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

$H_0$: The Covid-19 vaccination has no effect on people in different sub group  

$H_A$: The Covid-19 vacciantion does have an effect on people in different sub groups  

## Males

$H_0$: Covid-19 is not effective in males  

$H_A$: Covid-19 is effective in males  

### Methods

Treatment is a categorical variable  

Sex is a categorical variable  

so we use the cat~cat helper file  

## Results
## Descriptive Results

### Graphical Summary

```{r}
males=filter(FinalData,FinalData$sex=="M")
barchartGC(~treatment + infected,data=males)
barchartGC(~infected + treatment,data=males, type="percent")
```

The chart shows that males who received the placebo had gotten much more positive Covid-19 results and those who had gotten the vaccine had a lower amount in position Covid-19 results.  

### Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=males)
rowPerc(table1)
colPerc(table1)
```

The table shows that 74% of males who recieved the placebo got Covid-19 and 26% of males who got the vaccine got Covid-19.  

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The inferential results using a chi-squared test showed that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05     

## Females

$H_0$: Covid-19 vaccine is not effective in females  

$H_A$: Covid-19 vaccine is effective in females  

### Methods

Treatment is a categorical variable  

Sex is a categorical variable  

so we use the cat~cat helper file  

### Descriptive Results

### Graphical Summary

```{r}
females=filter(FinalData,FinalData$sex=="F")
barchartGC(~treatment + infected,data=females)
barchartGC(~infected + treatment,data=females, type="percent")
```

The chart shows that in females those who received the placebo had gotten more positive Covid-19 results and those who had gotten the vaccine had a much lower amount in positive Covid-19 results.  

### Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=females)
rowPerc(table1)
colPerc(table1)
```

The numerical results shows that 65% of those who got the placebo got Covid-19 and that 35% of those who got the vaccine got Covid-19  

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The inferential results using chi-squared test shows that the p-value is 0.00000001914 therefore we reject the null hypothesis because it is less than 0.05. The test also showed that females have a odd ratio of 1.8 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

## LGBTQ

$H_0$: Covid-19 vaccine is not effective in LGBTQ community  

$H_A$: Covid-19 vaccine is effective in LGBTQ community  

### Methods

Treatment is a categorical variable  

LGBTQ is a categorical variable  

So we use the cat~cat helper file  

### Graphical Summary

```{r}
LGBTQ=filter(FinalData,FinalData$LGBTQ=="gay")
barchartGC(~treatment + infected,data=LGBTQ)
barchartGC(~infected + treatment,data=LGBTQ, type="percent")
```

The table shows that in the LGBTQ community there was more positive Covid-19 results among those who has received the placebo and the ones that had gotten the vaccine and much lower positive Covid-19 results.  

### Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=LGBTQ)
rowPerc(table1)
colPerc(table1)
```

The numerical results showed that 80% of those who got the placebo got Covid-19 and that 20% of those who got the vaccine got Covid-19.  

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The inferential results using chi-squared test shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05  

The Fisher's Exact Test for Count Data shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05. The test also indicates that LGBTQ have a odd ratio of 4.2 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

## Druggies
 $H_0$: Covid-19 vaccine is not effective in drug users  
 
 $H_A$ Covid- 19 is effective in drug users  
 
### Methods 

Treatment is a categorical variable  

Drug users is a categorical variable  

so we use the cat~cat helper file  

### Descriptive Results 

### Graphical Summary

```{r}
DrugUser=filter(FinalData)
barchartGC(~treatment + infected,data=DrugUser)
barchartGC(~infected + treatment,data=DrugUser, type="percent")
```

The table shows that among the DrugUsers there was more positive Covid-19 results among those who has received the placebo and the ones that had gotten the vaccine and much lower positive Covid-19 results.  

### Numerical Summary

```{r}
table1 <- xtabs(~treatment + infected, data=DrugUser)
rowPerc(table1)
colPerc(table1)
```

The numerical results showed that 69% of those who got the placebo got Covid-19 and that 31% of those who got the vaccine got Covid-19  

### Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

The inferential results using a chi-squared test shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05  

The Fisher's Exact Test for Count Data shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05. The test also indicates that DrugUsers have a odd ratio of 2.2 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

# Overall Results and Conclusions

The inferential results using chi-squared test shows that the p-value is 0.00000001914 therefore we reject the null hypothesis because it is less than 0.05. The test also showed that females have a odd ratio of 1.8 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

The Fisher's Exact Test for Count Data shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05. The test also indicates that LGBTQ have a odd ratio of 4.2 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

The Fisher's Exact Test for Count Data shows that the p-value is 0.00000000000000022 therefore we reject the null hypothesis because it is less than 0.05. The test also indicates that DrugUsers have a odd ratio of 2.2 times more likely to get Covid-19 with a placebo compared to those who got the vaccine.  

The difference in odd ratio in different subgroups prove there is a statistical difference in each group in terms of those who did and didn't receive the drug, proving that there is a difference in the effectiveness of the drug in different sub groups.  